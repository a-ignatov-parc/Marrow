/**
 * Marrow - v0.3.4-5 (build date: 30/06/2013)
 * https://github.com/a-ignatov-parc/Marrow
 * Sandbox webapp loading framework with conditional recipes
 * Copyright (c) 2013 Anton Ignatov
 * Licensed MIT
 */
window.YES=!0,window.NO=!1,window.WebApp||(window.WebApp={}),window.WebApp.Core=function(a,b,c){var d=/[:.\-\s\/]+/,e=function(){var a,d=Array.prototype.slice.call(arguments),e=d.shift(),f=d.pop();if(!this.constructor._transits)return console.error("No transits registered in collection!"),void 0;if("object"!=typeof f)throw"Last argument should be options object!";d.length||console.info("No transits found in arguments. Skiping...");for(var g=0,h=d.length;h>g;g++)"string"==typeof d[g]?(a=d[g].toLowerCase(),this.constructor._transits[a]?"function"==typeof this.constructor._transits[a][e]?this.constructor._transits[a][e].call(this,b,c,f):console.warn('No "'+e+'" method for transit with name "'+d[g]+'" were found! Skipping...'):console.warn('No transit with name "'+d[g]+'" were found! Skipping...')):console.warn("Transit name should be string! Skipping...",d[g])};this.version="0.3.4-5",this.global=b,this.debugMode=NO,this.rootHost=null,this.strictMode=YES,this.sandbox=c,this.hosts={init:"/",request:"/",js:"/js",img:"/img",html:"/html",css:"/styles/css"},this._globalLinks={},this.list=[],this.useTransits=function(){return e.apply(this,["bind"].concat(Array.prototype.slice.call(arguments)))},this.removeTransits=function(){return e.apply(this,["unbind"].concat(Array.prototype.slice.call(arguments)))},this.Perf=function(){var a,c,d=["now","webkitNow","msNow","mozNow"],e=function(){return c?b.performance[c]():Date.now()};if(null!=b.performance)for(var f=0,g=d.length;g>f;f++)if(d[f]&&d[f]in b.performance){c=d[f];break}this.start=function(){a=e()},this.end=function(){return a?e()-a:0}},this.generateId=function(){return(Math.floor(1e4*Math.random())+"00000").slice(0,5)},this.getLocationHash=function(a){var b=a?a.location:c.location,d=b.href.match(/#(.*)$/);return d?d[1]:""},this.bind=function(a,c){return c||(c=b),"function"==typeof a?function(){return a.apply(c,arguments)}:NO},this.aliasMerge=function(a){var b,c={},d={},e=[].slice.call(arguments,1),f=e.shift();for(b in a)a.hasOwnProperty(b)&&"string"==typeof a[b]&&(d[a[b]]=b);for(;f;){for(b in f)f.hasOwnProperty(b)&&d[b]&&f[b]&&(c[d[b]]=f[b]);f=e.shift()}return c},this.links=function(a,b,c){this._globalLinks||(this._globalLinks={});var d=!!a,e=null!=b;if(e&&d){if("string"!=typeof a)return NO;if(this._globalLinks[a]){if(!c)return NO;_.extend(this._globalLinks[a],b)}else this._globalLinks[a]=b}else{if(d)return this._globalLinks[a];if(e)return NO}return this._globalLinks},this.domBuilder=function(a,b){if("function"!=typeof jQuery)throw"This method require jQuery to be defined!";var c=[document.createElement(a)];return $.fn.attr.call(c,b,YES),$.merge($(),c)},this.observatory=new a.Observatory,this.clone=function(a){return JSON.parse(JSON.stringify(a))},this.formatDate=function(a,b,c){return c=[],b||(b=2),c.length=b,(c.join("0")+a).slice(-b)},this.dateUTC=function(a,b,c){var e,f;if(a&&(f=new Date(a)),(!f||isNaN(f.getTime()))&&(f=new Date),e={wd:f.getUTCDay(),dd:f.getUTCDate(),h:f.getUTCHours(),mm:f.getUTCMonth(),m:f.getUTCMinutes(),s:f.getUTCSeconds(),hh:f.getUTCFullYear(),ms:f.getUTCMilliseconds(),WD:this.formatDate(f.getUTCDay()),DD:this.formatDate(f.getUTCDate()),H:this.formatDate(f.getUTCHours()),M:this.formatDate(f.getUTCMinutes()),S:this.formatDate(f.getUTCSeconds()),MM:this.formatDate(f.getUTCMonth()+1),HH:this.formatDate(f.getUTCFullYear(),4),MS:this.formatDate(f.getUTCMilliseconds(),3),timestamp:f.valueOf()},b){var g=b.split(d);if(g&&g.length)for(var h=0,i=g.length;i>h;h++)e[g[h]]&&(c?g[h]=e[g[h]]:b=b.replace(g[h],e[g[h]]));return c?g:b}return e},this.toArray=function(a,b){var c,d=[];if(b=_.extend({name:"name",value:"value"},b),a)if(a.length)d=a.slice(0);else for(var e in a)a.hasOwnProperty(e)&&(c=d[d.push({})-1],c[b.name]=e,c[b.value]=a[e]);return d},this.toObject=function(a){var b={};if(a)if(a.push&&a.length)for(var c,d,e=0,f=a.length;f>e;e++)c=a[e],d=b[c.name],d?(d.push||(b[c.name]=[d]),b[c.name].push(c.value)):b[c.name]=c.value;else b=a;return b},this.cookie=function(a,b){var c=function(a){var b=new RegExp(a.replace(/\s+/,"")+"=([^;]*)","gi"),c=b.exec(document.cookie);return c&&JSON.parse(c[1])},d=[];if(!a)return document.cookie;if("string"==typeof a&&(a=a.split(",")),a instanceof Array){for(var e=[],f=0,g=a.length;g>f;f++)e.push(c(a[f]));return e}for(var h in a)if(a.hasOwnProperty(h)){var i=[h+"="+JSON.stringify(a[h]),"path=/","expires=Mon, 01-Jan-"+(null==a[h]?"1900":"2100")+" 00:00:00 GMT"];b&&i.pop(),d.push(h),document.cookie=i.join(";")}return arguments.callee(d)}},window.WebApp.Core.prototype={constructor:window.WebApp.Core},window.WebApp.Core.registerTransit=function(a,b,c){this._transits||(this._transits={}),"string"==typeof a&&"function"==typeof b?(a=a.toLowerCase(),this._transits[a]?console.error("Transit with name: "+a+" was already registered."):this._transits[a]={bind:b,unbind:c}):console.error('Wrong arguments type! Should be "string" + "function" but get "'+typeof a+'" and "'+typeof b+'"')},function(a){a.Core.registerTransit("jquery",function(a,b,c){try{if(c.loadOptions.disableTransits.jquery)return}catch(d){console.error(d)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(b.getComputedStyle&&a.getComputedStyle&&(b.getComputedStyle=function(){return a.getComputedStyle.apply(a,arguments)}),jQuery.fn.init=function(c,d){var e=function(d,e,f){return"string"!=typeof d||e?d==b&&e!=b?new c(a,e,f):d==b.document?new c(a.document,e,f):d==b.document.head?new c(a.document.head,e,f):d==b.document.body?new c(a.document.body,e,f):new c(d,e,f):new c(d,a.document,f)};return e.prototype=d,e}(jQuery.fn.init,jQuery.fn),void 0)})}(window.WebApp),function(a){var b,c,d,e,f;a.Core.registerTransit("location",function(a,g,h){try{if(h.loadOptions.disableTransits.location)return}catch(i){console.error(i)}if("function"!=typeof jQuery)return console.error("This transit require jQuery to be defined!"),void 0;d=$(g,g),e=$(a);var j=this.getLocationHash(),k=this.getLocationHash(a),l=this.bind(function(){var b=this.getLocationHash(),c=this.getLocationHash(a);j!=b?(k=j=b,a.location.hash=k):k!=c&&(j=k=c,g.location.hash=j)},this);f=this.generateId(),a.history&&a.history.pushState&&(b=g.history.pushState,g.history.pushState=null),"onhashchange"in a?(e.on("hashchange.marrow"+f,l),d.on("hashchange.marrow"+f,l)):c=setInterval(l,50),k=j,l()},function(a,g,h){try{if(h.loadOptions.disableTransits.location)return}catch(i){console.error(i)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(c&&clearInterval(c),d.off(".marrow"+f),e.off(".marrow"+f),g.history.pushState=b,void 0)})}(window.WebApp),null==window.console&&(window.console={},console.log=console.info=console.warn=console.debug=console.group=console.groupEnd=console.error=console.time=console.timeEnd=function(){}),window.WebApp||(window.WebApp={}),window.WebApp.Observatory=function(){var a=/\s+/,b=[],c=[],d={},e={},f={};this.on=function(g,h,i){var j,k,l,m,n,o=c.length;if(!g||!h||"function"!=typeof h)return console.error("No event name or handler! Skipping..."),this;for(l=g.indexOf(" ")>=0?g.split(a):[g],c.push(h),b.push(i);l.length;)j=null,m=null,k=l.shift(),n=k.lastIndexOf("."),n>=0?(j=k.substring(0,n),m=k.substring(n)):j=k,j&&m&&(d[k]||(d[k]=[]),d[k].push(o)),m&&(d[m]||(d[m]=[]),d[m].push(o)),j&&(d[j]||(d[j]=[]),d[j].push(o)),(e[k]||e[j]||e[m])&&(f[o]=c[o],c[o]=null);return this},this.off=function(e,f,g){var h,i,j,k;for(j=e.indexOf(" ")>=0?e.split(a):[e];j.length;)if(h=j.shift(),i=d[h])for(var l=0,m=i.length;m>l;l++)k=i[l],c[k]&&(f&&f!=c[k]||g&&b[k]!=g||(c[k]=b[k]=null));return this},this.trigger=function(a,e){var f,g,h;if(!a)return console.error("No event name! Skipping..."),this;if(a.indexOf(" ")>=0&&(a=a.replace(" ","")),f=d[a])for(var i=0,j=f.length;j>i;i++)if(h=f[i],g=c[h])try{"object"==typeof e&&"function"==typeof e.concat&&"number"==typeof e.length&&e.length?g.apply(b[h],[a].concat(e)):g.call(b[h],a,e)}catch(k){console.error(k)}return this},this.mute=function(b){var g,h,i,j;if(!b)return console.error("No event name! Skipping..."),this;for(i=b.indexOf(" ")>=0?b.split(a):[b];i.length;)if(g=i.shift(),!e[g]&&(e[g]=1,h=d[g]))for(var k=0,l=h.length;l>k;k++)j=h[k],f[j]||(f[j]=c[j],c[j]=null);return this},this.unmute=function(b){var e,g,h,i;if(!b)return console.error("No event name! Skipping..."),this;for(h=b.indexOf(" ")>=0?b.split(a):[b];h.length;)if(e=h.shift(),g=d[e])for(var j=0,k=g.length;k>j;j++)i=g[j],f[i]&&(c[i]=f[i],delete f[i]);return this}};