/**
 * Marrow - v0.3.6-188 (build date: 28/05/2013)
 * https://github.com/a-ignatov-parc/Marrow
 * Sandbox webapp loading framework with conditional recipes
 * Copyright (c) 2013 Anton Ignatov <abietis@gmail.com>
 */
window.YES=!0,window.NO=!1,window.WebApp||(window.WebApp={}),window.WebApp.Core=function(t,e,n){var r=/[:.\-\s\/]+/,o=function(){var t,r=Array.prototype.slice.call(arguments),o=r.shift(),i=r.pop();if(!this.constructor._transits)return console.error("No transits registered in collection!"),void 0;if("object"!=typeof i)throw"Last argument should be options object!";r.length||console.info("No transits found in arguments. Skiping...");for(var s=0,a=r.length;a>s;s++)"string"==typeof r[s]?(t=r[s].toLowerCase(),this.constructor._transits[t]?"function"==typeof this.constructor._transits[t][o]?this.constructor._transits[t][o].call(this,e,n,i):console.warn('No "'+o+'" method for transit with name "'+r[s]+'" were found! Skipping...'):console.warn('No transit with name "'+r[s]+'" were found! Skipping...')):console.warn("Transit name should be string! Skipping...",r[s])};this.version="0.3.6-188",this.global=e,this.debugMode=NO,this.rootHost=null,this.strictMode=YES,this.sandbox=n,this.hosts={init:"/",request:"/",js:"/js",img:"/img",html:"/html",css:"/styles/css"},this._globalLinks={},this.list=[],this.useTransits=function(){return o.apply(this,["bind"].concat(Array.prototype.slice.call(arguments)))},this.removeTransits=function(){return o.apply(this,["unbind"].concat(Array.prototype.slice.call(arguments)))},this.Perf=function(){for(var t,n,r=["now","webkitNow","msNow","mozNow"],o=function(){return n?e.performance[n]():Date.now()},i=0,s=r.length;s>i;i++)if(r[i]&&r[i]in e.performance){n=r[i];break}this.start=function(){t=o()},this.end=function(){return t?o()-t:0}},this.generateId=function(){return(Math.floor(1e4*Math.random())+"00000").slice(0,5)},this.getLocationHash=function(t){var e=t?t.location:n.location,r=e.href.match(/#(.*)$/);return r?r[1]:""},this.bind=function(t,n){return n||(n=e),"function"==typeof t?function(){return t.apply(n,arguments)}:NO},this.aliasMerge=function(t){var e,n={},r={},o=[].slice.call(arguments,1),i=o.shift();for(e in t)t.hasOwnProperty(e)&&"string"==typeof t[e]&&(r[t[e]]=e);for(;i;){for(e in i)i.hasOwnProperty(e)&&r[e]&&i[e]&&(n[r[e]]=i[e]);i=o.shift()}return n},this.links=function(t,e,n){this._globalLinks||(this._globalLinks={});var r=!!t,o=null!=e;if(o&&r){if("string"!=typeof t)return NO;if(this._globalLinks[t]){if(!n)return NO;_.extend(this._globalLinks[t],e)}else this._globalLinks[t]=e}else{if(r)return this._globalLinks[t];if(o)return NO}return this._globalLinks},this.domBuilder=function(t,e){if("function"!=typeof jQuery)throw"This method require jQuery to be defined!";var n=[document.createElement(t)];return $.fn.attr.call(n,e,YES),$.merge($(),n)},this.observatory=new t.Observatory,this.clone=function(t){return JSON.parse(JSON.stringify(t))},this.formatDate=function(t,e,n){return n=[],e||(e=2),n.length=e,(n.join("0")+t).slice(-e)},this.dateUTC=function(t,e,n){var o,i;if(t&&(i=new Date(t)),(!i||isNaN(i.getTime()))&&(i=new Date),o={wd:i.getUTCDay(),dd:i.getUTCDate(),h:i.getUTCHours(),mm:i.getUTCMonth(),m:i.getUTCMinutes(),s:i.getUTCSeconds(),hh:i.getUTCFullYear(),ms:i.getUTCMilliseconds(),WD:this.formatDate(i.getUTCDay()),DD:this.formatDate(i.getUTCDate()),H:this.formatDate(i.getUTCHours()),M:this.formatDate(i.getUTCMinutes()),S:this.formatDate(i.getUTCSeconds()),MM:this.formatDate(i.getUTCMonth()+1),HH:this.formatDate(i.getUTCFullYear(),4),MS:this.formatDate(i.getUTCMilliseconds(),3),timestamp:i.valueOf()},e){var s=e.split(r);if(s&&s.length)for(var a=0,u=s.length;u>a;a++)o[s[a]]&&(n?s[a]=o[s[a]]:e=e.replace(s[a],o[s[a]]));return n?s:e}return o},this.toArray=function(t,e){var n,r=[];if(e=_.extend({name:"name",value:"value"},e),t)if(t.length)r=t.slice(0);else for(var o in t)t.hasOwnProperty(o)&&(n=r[r.push({})-1],n[e.name]=o,n[e.value]=t[o]);return r},this.toObject=function(t){var e={};if(t)if(t.push&&t.length)for(var n,r,o=0,i=t.length;i>o;o++)n=t[o],r=e[n.name],r?(r.push||(e[n.name]=[r]),e[n.name].push(n.value)):e[n.name]=n.value;else e=t;return e},this.cookie=function(t,e){var n=function(t){var e=RegExp(t.replace(/\s+/,"")+"=([^;]*)","gi"),n=e.exec(document.cookie);return n&&JSON.parse(n[1])},r=[];if(!t)return document.cookie;if("string"==typeof t&&(t=t.split(",")),t instanceof Array){for(var o=[],i=0,s=t.length;s>i;i++)o.push(n(t[i]));return o}for(var a in t)if(t.hasOwnProperty(a)){var u=[a+"="+JSON.stringify(t[a]),"path=/","expires=Mon, 01-Jan-"+(null==t[a]?"1900":"2100")+" 00:00:00 GMT"];e&&u.pop(),r.push(a),document.cookie=u.join(";")}return arguments.callee(r)}},window.WebApp.Core.prototype={constructor:window.WebApp.Core},window.WebApp.Core.registerTransit=function(t,e,n){this._transits||(this._transits={}),"string"==typeof t&&"function"==typeof e?(t=t.toLowerCase(),this._transits[t]?console.error("Transit with name: "+t+" was already registered."):this._transits[t]={bind:e,unbind:n}):console.error('Wrong arguments type! Should be "string" + "function" but get "'+typeof t+'" and "'+typeof e+'"')},function(t){t.Core.registerTransit("jquery",function(t,e,n){try{if(n.loadOptions.disableTransits.jquery)return}catch(r){console.error(r)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(e.getComputedStyle&&t.getComputedStyle&&(e.getComputedStyle=function(){return t.getComputedStyle.apply(t,arguments)}),jQuery.fn.init=function(n,r){var o=function(r,o,i){return"string"!=typeof r||o?r==e&&o!=e?new n(t,o,i):r==e.document?new n(t.document,o,i):r==e.document.head?new n(t.document.head,o,i):r==e.document.body?new n(t.document.body,o,i):new n(r,o,i):new n(r,t.document,i)};return o.prototype=r,o}(jQuery.fn.init,jQuery.fn),void 0)})}(window.WebApp),function(t){var e,n,r,o,i;t.Core.registerTransit("location",function(t,s,a){try{if(a.loadOptions.disableTransits.location)return}catch(u){console.error(u)}if("function"!=typeof jQuery)return console.error("This transit require jQuery to be defined!"),void 0;r=$(s,s),o=$(t);var l=this.getLocationHash(),h=this.getLocationHash(t),c=this.bind(function(){var e=this.getLocationHash(),n=this.getLocationHash(t);l!=e?(h=l=e,t.location.hash=h):h!=n&&(l=h=n,s.location.hash=l)},this);i=this.generateId(),t.history&&t.history.pushState&&(e=s.history.pushState,s.history.pushState=null),"onhashchange"in t?(o.on("hashchange.marrow"+i,c),r.on("hashchange.marrow"+i,c)):n=setInterval(c,50),h=l,c()},function(t,s,a){try{if(a.loadOptions.disableTransits.location)return}catch(u){console.error(u)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(n&&clearInterval(n),r.off(".marrow"+i),o.off(".marrow"+i),s.history.pushState=e,void 0)})}(window.WebApp),null==window.console&&(window.console={},console.log=console.info=console.warn=console.debug=console.group=console.groupEnd=console.error=console.time=console.timeEnd=function(){}),window.WebApp||(window.WebApp={}),window.WebApp.Observatory=function(){var t=/\s+/,e=[],n=[],r={},o={},i={};this.on=function(s,a,u){var l,h,c,f,p,g=n.length;if(!s||!a||"function"!=typeof a)return console.error("No event name or handler! Skipping..."),this;for(c=s.indexOf(" ")>=0?s.split(t):[s],n.push(a),e.push(u);c.length;)l=null,f=null,h=c.shift(),p=h.lastIndexOf("."),p>=0?(l=h.substring(0,p),f=h.substring(p)):l=h,l&&f&&(r[h]||(r[h]=[]),r[h].push(g)),f&&(r[f]||(r[f]=[]),r[f].push(g)),l&&(r[l]||(r[l]=[]),r[l].push(g)),(o[h]||o[l]||o[f])&&(i[g]=n[g],n[g]=null);return this},this.off=function(o,i,s){var a,u,l,h;for(l=o.indexOf(" ")>=0?o.split(t):[o];l.length;)if(a=l.shift(),u=r[a])for(var c=0,f=u.length;f>c;c++)h=u[c],n[h]&&(i&&i!=n[h]||s&&e[h]!=s||(n[h]=e[h]=null));return this},this.trigger=function(t,o){var i,s,a;if(!t)return console.error("No event name! Skipping..."),this;if(t.indexOf(" ")>=0&&(t=t.replace(" ","")),i=r[t])for(var u=0,l=i.length;l>u;u++)if(a=i[u],s=n[a])try{"object"==typeof o&&"function"==typeof o.concat&&"number"==typeof o.length&&o.length?s.apply(e[a],[t].concat(o)):s.call(e[a],t,o)}catch(h){console.error(h)}return this},this.mute=function(e){var s,a,u,l;if(!e)return console.error("No event name! Skipping..."),this;for(u=e.indexOf(" ")>=0?e.split(t):[e];u.length;)if(s=u.shift(),!o[s]&&(o[s]=1,a=r[s]))for(var h=0,c=a.length;c>h;h++)l=a[h],i[l]||(i[l]=n[l],n[l]=null);return this},this.unmute=function(e){var o,s,a,u;if(!e)return console.error("No event name! Skipping..."),this;for(a=e.indexOf(" ")>=0?e.split(t):[e];a.length;)if(o=a.shift(),s=r[o])for(var l=0,h=s.length;h>l;l++)u=s[l],i[u]&&(n[u]=i[u],delete i[u]);return this}};