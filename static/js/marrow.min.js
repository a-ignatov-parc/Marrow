/**
 * Marrow - v0.3.6-192 (build date: 03/06/2013)
 * https://github.com/a-ignatov-parc/Marrow
 * Sandbox webapp loading framework with conditional recipes
 * Copyright (c) 2013 Anton Ignatov <abietis@gmail.com>
 */
window.YES=!0,window.NO=!1,window.WebApp||(window.WebApp={}),window.WebApp.Core=function(t,n,e){var o=/[:.\-\s\/]+/,i=function(){var t,o=Array.prototype.slice.call(arguments),i=o.shift(),r=o.pop();if(!this.constructor._transits)return console.error("No transits registered in collection!"),void 0;if("object"!=typeof r)throw"Last argument should be options object!";o.length||console.info("No transits found in arguments. Skiping...");for(var s=0,a=o.length;a>s;s++)"string"==typeof o[s]?(t=o[s].toLowerCase(),this.constructor._transits[t]?"function"==typeof this.constructor._transits[t][i]?this.constructor._transits[t][i].call(this,n,e,r):console.warn('No "'+i+'" method for transit with name "'+o[s]+'" were found! Skipping...'):console.warn('No transit with name "'+o[s]+'" were found! Skipping...')):console.warn("Transit name should be string! Skipping...",o[s])};this.version="0.3.6-192",this.global=n,this.debugMode=NO,this.rootHost=null,this.strictMode=YES,this.sandbox=e,this.hosts={init:"/",request:"/",js:"/js",img:"/img",html:"/html",css:"/styles/css"},this._globalLinks={},this.list=[],this.useTransits=function(){return i.apply(this,["bind"].concat(Array.prototype.slice.call(arguments)))},this.removeTransits=function(){return i.apply(this,["unbind"].concat(Array.prototype.slice.call(arguments)))},this.Perf=function(){var t,e,o=["now","webkitNow","msNow","mozNow"],i=function(){return e?n.performance[e]():Date.now()};if(null!=n.performance)for(var r=0,s=o.length;s>r;r++)if(o[r]&&o[r]in n.performance){e=o[r];break}this.start=function(){t=i()},this.end=function(){return t?i()-t:0}},this.generateId=function(){return(Math.floor(1e4*Math.random())+"00000").slice(0,5)},this.getLocationHash=function(t){var n=t?t.location:e.location,o=n.href.match(/#(.*)$/);return o?o[1]:""},this.bind=function(t,e){return e||(e=n),"function"==typeof t?function(){return t.apply(e,arguments)}:NO},this.aliasMerge=function(t){var n,e={},o={},i=[].slice.call(arguments,1),r=i.shift();for(n in t)t.hasOwnProperty(n)&&"string"==typeof t[n]&&(o[t[n]]=n);for(;r;){for(n in r)r.hasOwnProperty(n)&&o[n]&&r[n]&&(e[o[n]]=r[n]);r=i.shift()}return e},this.links=function(t,n,e){this._globalLinks||(this._globalLinks={});var o=!!t,i=null!=n;if(i&&o){if("string"!=typeof t)return NO;if(this._globalLinks[t]){if(!e)return NO;_.extend(this._globalLinks[t],n)}else this._globalLinks[t]=n}else{if(o)return this._globalLinks[t];if(i)return NO}return this._globalLinks},this.domBuilder=function(t,n){if("function"!=typeof jQuery)throw"This method require jQuery to be defined!";var e=[document.createElement(t)];return $.fn.attr.call(e,n,YES),$.merge($(),e)},this.observatory=new t.Observatory,this.clone=function(t){return JSON.parse(JSON.stringify(t))},this.formatDate=function(t,n,e){return e=[],n||(n=2),e.length=n,(e.join("0")+t).slice(-n)},this.dateUTC=function(t,n,e){var i,r;if(t&&(r=new Date(t)),(!r||isNaN(r.getTime()))&&(r=new Date),i={wd:r.getUTCDay(),dd:r.getUTCDate(),h:r.getUTCHours(),mm:r.getUTCMonth(),m:r.getUTCMinutes(),s:r.getUTCSeconds(),hh:r.getUTCFullYear(),ms:r.getUTCMilliseconds(),WD:this.formatDate(r.getUTCDay()),DD:this.formatDate(r.getUTCDate()),H:this.formatDate(r.getUTCHours()),M:this.formatDate(r.getUTCMinutes()),S:this.formatDate(r.getUTCSeconds()),MM:this.formatDate(r.getUTCMonth()+1),HH:this.formatDate(r.getUTCFullYear(),4),MS:this.formatDate(r.getUTCMilliseconds(),3),timestamp:r.valueOf()},n){var s=n.split(o);if(s&&s.length)for(var a=0,u=s.length;u>a;a++)i[s[a]]&&(e?s[a]=i[s[a]]:n=n.replace(s[a],i[s[a]]));return e?s:n}return i},this.toArray=function(t,n){var e,o=[];if(n=_.extend({name:"name",value:"value"},n),t)if(t.length)o=t.slice(0);else for(var i in t)t.hasOwnProperty(i)&&(e=o[o.push({})-1],e[n.name]=i,e[n.value]=t[i]);return o},this.toObject=function(t){var n={};if(t)if(t.push&&t.length)for(var e,o,i=0,r=t.length;r>i;i++)e=t[i],o=n[e.name],o?(o.push||(n[e.name]=[o]),n[e.name].push(e.value)):n[e.name]=e.value;else n=t;return n},this.cookie=function(t,n){var e=function(t){var n=RegExp(t.replace(/\s+/,"")+"=([^;]*)","gi"),e=n.exec(document.cookie);return e&&JSON.parse(e[1])},o=[];if(!t)return document.cookie;if("string"==typeof t&&(t=t.split(",")),t instanceof Array){for(var i=[],r=0,s=t.length;s>r;r++)i.push(e(t[r]));return i}for(var a in t)if(t.hasOwnProperty(a)){var u=[a+"="+JSON.stringify(t[a]),"path=/","expires=Mon, 01-Jan-"+(null==t[a]?"1900":"2100")+" 00:00:00 GMT"];n&&u.pop(),o.push(a),document.cookie=u.join(";")}return arguments.callee(o)}},window.WebApp.Core.prototype={constructor:window.WebApp.Core},window.WebApp.Core.registerTransit=function(t,n,e){this._transits||(this._transits={}),"string"==typeof t&&"function"==typeof n?(t=t.toLowerCase(),this._transits[t]?console.error("Transit with name: "+t+" was already registered."):this._transits[t]={bind:n,unbind:e}):console.error('Wrong arguments type! Should be "string" + "function" but get "'+typeof t+'" and "'+typeof n+'"')},function(t){t.Core.registerTransit("jquery",function(t,n,e){try{if(e.loadOptions.disableTransits.jquery)return}catch(o){console.error(o)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(n.getComputedStyle&&t.getComputedStyle&&(n.getComputedStyle=function(){return t.getComputedStyle.apply(t,arguments)}),jQuery.fn.init=function(e,o){var i=function(o,i,r){return"string"!=typeof o||i?o==n&&i!=n?new e(t,i,r):o==n.document?new e(t.document,i,r):o==n.document.head?new e(t.document.head,i,r):o==n.document.body?new e(t.document.body,i,r):new e(o,i,r):new e(o,t.document,r)};return i.prototype=o,i}(jQuery.fn.init,jQuery.fn),void 0)})}(window.WebApp),function(t){var n,e,o,i,r;t.Core.registerTransit("location",function(t,s,a){try{if(a.loadOptions.disableTransits.location)return}catch(u){console.error(u)}if("function"!=typeof jQuery)return console.error("This transit require jQuery to be defined!"),void 0;o=$(s,s),i=$(t);var c=this.getLocationHash(),l=this.getLocationHash(t),h=this.bind(function(){var n=this.getLocationHash(),e=this.getLocationHash(t);c!=n?(l=c=n,t.location.hash=l):l!=e&&(c=l=e,s.location.hash=c)},this);r=this.generateId(),t.history&&t.history.pushState&&(n=s.history.pushState,s.history.pushState=null),"onhashchange"in t?(i.on("hashchange.marrow"+r,h),o.on("hashchange.marrow"+r,h)):e=setInterval(h,50),l=c,h()},function(t,s,a){try{if(a.loadOptions.disableTransits.location)return}catch(u){console.error(u)}return"function"!=typeof jQuery?(console.error("This transit require jQuery to be defined!"),void 0):(e&&clearInterval(e),o.off(".marrow"+r),i.off(".marrow"+r),s.history.pushState=n,void 0)})}(window.WebApp),null==window.console&&(window.console={},console.log=console.info=console.warn=console.debug=console.group=console.groupEnd=console.error=console.time=console.timeEnd=function(){}),window.WebApp||(window.WebApp={}),window.WebApp.Observatory=function(){var t=/\s+/,n=[],e=[],o={},i={},r={};this.on=function(s,a,u){var c,l,h,f,d,p=e.length;if(!s||!a||"function"!=typeof a)return console.error("No event name or handler! Skipping..."),this;for(h=s.indexOf(" ")>=0?s.split(t):[s],e.push(a),n.push(u);h.length;)c=null,f=null,l=h.shift(),d=l.lastIndexOf("."),d>=0?(c=l.substring(0,d),f=l.substring(d)):c=l,c&&f&&(o[l]||(o[l]=[]),o[l].push(p)),f&&(o[f]||(o[f]=[]),o[f].push(p)),c&&(o[c]||(o[c]=[]),o[c].push(p)),(i[l]||i[c]||i[f])&&(r[p]=e[p],e[p]=null);return this},this.off=function(i,r,s){var a,u,c,l;for(c=i.indexOf(" ")>=0?i.split(t):[i];c.length;)if(a=c.shift(),u=o[a])for(var h=0,f=u.length;f>h;h++)l=u[h],e[l]&&(r&&r!=e[l]||s&&n[l]!=s||(e[l]=n[l]=null));return this},this.trigger=function(t,i){var r,s,a;if(!t)return console.error("No event name! Skipping..."),this;if(t.indexOf(" ")>=0&&(t=t.replace(" ","")),r=o[t])for(var u=0,c=r.length;c>u;u++)if(a=r[u],s=e[a])try{"object"==typeof i&&"function"==typeof i.concat&&"number"==typeof i.length&&i.length?s.apply(n[a],[t].concat(i)):s.call(n[a],t,i)}catch(l){console.error(l)}return this},this.mute=function(n){var s,a,u,c;if(!n)return console.error("No event name! Skipping..."),this;for(u=n.indexOf(" ")>=0?n.split(t):[n];u.length;)if(s=u.shift(),!i[s]&&(i[s]=1,a=o[s]))for(var l=0,h=a.length;h>l;l++)c=a[l],r[c]||(r[c]=e[c],e[c]=null);return this},this.unmute=function(n){var i,s,a,u;if(!n)return console.error("No event name! Skipping..."),this;for(a=n.indexOf(" ")>=0?n.split(t):[n];a.length;)if(i=a.shift(),s=o[i])for(var c=0,l=s.length;l>c;c++)u=s[c],r[u]&&(e[u]=r[u],delete r[u]);return this}};